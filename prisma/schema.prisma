generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id              String               @id @default(uuid())
  email           String               @unique
  createdAt       DateTime             @default(now())
  updatedAt       DateTime             @updatedAt
  name            String?
  profileImageUrl String?
  recommendations CityRecommendation[]
  reviews         Review[]
  preferences     UserPreferences?
}

model Review {
  id        String       @id @default(uuid())
  comment   String
  city      CanadianCity
  userId    String
  createdAt DateTime     @default(now())
  updatedAt DateTime     @updatedAt
  user      User         @relation(fields: [userId], references: [id])
}

model UserPreferences {
  id                String             @id @default(uuid())
  userId            String             @unique
  jobField          JobField
  costOfLiving      CostOfLiving
  rentalPrice       Int?
  weather           WeatherPreference
  province          Province?
  lifeStage         LifeStage
  language          LanguagePreference
  immigrationStatus ImmigrationStatus
  citySize          CitySize?
  createdAt         DateTime           @default(now())
  updatedAt         DateTime           @updatedAt
  user              User               @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([jobField])
  @@index([province])
}

model CityRecommendation {
  id          String   @id @default(uuid())
  userId      String
  score       Float
  rank        Int
  generatedAt DateTime @default(now())
  city        String
  province    String
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model CityDetails {
  id                   String   @id @default(uuid())
  city                 String
  province             Province
  slug                 String   @unique
  imageKey             String?
  gallery              Json?
  jobOpportunities     Json?
  costOfLiving         Json?
  weather              Json?
  rent                 Json?
  realEstate           Json?
  qualityOfLife        Json?
  education            Json?
  healthcare           Json?
  communityIntegration Json?
  immigrationSupport   Json?
  safetyCrime          Json?
  transportation       Json?
  internetTech         Json?
  outdoorLifestyle     Json?
  demographics         Json?
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt

  @@unique([city, province])
  @@index([province])
}

model CityDataCache {
  id   Int    @id @default(autoincrement())
  city String
  data Json
}

enum CanadianCity {
  Airdrie
  Grande_Prairie
  Red_Deer
  Beaumont
  Hanna
  St_Albert
  Bonnyville
  Hinton
  Spruce_Grove
  Brazeau
  Irricana
  Strathcona_County
  Breton
  Lacombe
  Strathmore
  Calgary
  Leduc
  Sylvan_Lake
  Camrose
  Lethbridge
  Swan_Hills
  Canmore
  McLennan
  Taber
  Didzbury
  Medicine_Hat
  Turner_Valley
  Drayton_Valley
  Olds
  Vermillion
  Edmonton
  Onoway
  Wood_Buffalo
  Ft_Saskatchewan
  Provost
  Burnaby
  Lumby
  City_of_Port_Moody
  Cache_Creek
  Maple_Ridge
  Prince_George
  Castlegar
  Merritt
  Prince_Rupert
  Chemainus
  Mission
  Richmond
  Chilliwack
  Nanaimo
  Saanich
  Clearwater
  Nelson
  Sooke
  Colwood
  New_Westminster
  Sparwood
  Coquitlam
  North_Cowichan
  Surrey
  Cranbrook
  North_Vancouver
  Terrace
  Dawson_Creek
  Tumbler
  Delta
  Osoyoos
  Vancouver
  Fernie
  Parksville
  Invermere
  Peace_River
  Vernon
  Kamloops
  Penticton
  Victoria
  Kaslo
  Port_Alberni
  Whistler
  Langley
  Port_Hardy
  Birtle
  Flin_Flon
  Swan_River
  Brandon
  Snow_Lake
  The_Pas
  Cranberry_Portage
  Steinbach
  Thompson
  Dauphin
  Stonewall
  Winnipeg
  Cap_Pele
  Miramichi
  Saint_John
  Fredericton
  Moncton
  Saint_Stephen
  Grand_Bay_Westfield
  Oromocto
  Shippagan
  Grand_Falls
  Port_Elgin
  Sussex
  Memramcook
  Sackville
  Tracadie_Sheila
  Argentia
  Corner_Brook
  Paradise
  Bishops_Falls
  Labrador_City
  Portaux_Basques
  Botwood
  Mount_Pearl
  St_Johns
  Brigus
  Town_of_Hay_River
  Town_of_Inuvik
  Yellowknife
  Amherst
  Hants_County
  Pictou
  Annapolis
  Inverness_County
  Pictou_County
  Argyle
  Kentville
  Queens
  Baddeck
  County_of_Kings
  Bridgewater
  Lunenburg
  Shelburne
  Cape_Breton
  Lunenburg_County
  Stellarton
  Chester
  Mahone_Bay
  Truro
  Cumberland_County
  New_Glasgow
  Windsor
  East_Hants
  New_Minas
  Yarmouth
  Halifax
  Parrsboro
  Ajax
  Halton
  Peterborough
  Atikokan
  Halton_Hills
  Pickering
  Barrie
  Hamilton
  Port_Bruce
  Belleville
  Hamilton_Wentworth
  Port_Burwell
  Blandford_Blenheim
  Hearst
  Port_Colborne
  Blind_River
  Huntsville
  Port_Hope
  Brampton
  Ingersoll
  Prince_Edward
  Brant
  James
  Quinte_West
  Brantford
  Kanata
  Renfrew
  Brock
  Kincardine
  Richmond_Hill
  Brockville
  King
  Sarnia
  Burlington
  Kingston
  Sault_Ste_Marie
  Caledon
  Kirkland_Lake
  Scarborough
  Cambridge
  Kitchener
  Scugog
  Chatham_Kent
  Larder_Lake
  Souix_Lookout
  Chesterville
  Leamington
  Smiths_Falls
  Clarington
  Lennox_Addington
  South_West_Oxford
  Cobourg
  Lincoln
  St_Catharines
  Cochrane
  Lindsay
  St_Thomas
  Collingwood
  London
  Stoney_Creek
  Cornwall
  Loyalist_Township
  Cumberland
  Markham
  Sudbury
  Deep_River
  Metro_Toronto
  Temagami
  Dundas
  Merrickville
  Thorold
  Durham
  Milton
  Thunder_Bay
  Dymond
  Nepean
  Tillsonburg
  Ear_Falls
  Newmarket
  Timmins
  East_Gwillimbury
  Niagara
  Toronto
  East_Zorra_Tavistock
  Niagara_Falls
  Uxbridge
  Elgin
  Niagara_on_the_Lake
  Vaughan
  Elliot_Lake
  North_Bay
  Wainfleet
  Flamborough
  North_Dorchester
  Wasaga_Beach
  Fort_Erie
  North_Dumfries
  Waterloo
  Fort_Frances
  North_York
  Gananoque
  Norwich
  Welland
  Georgina
  Oakville
  Wellesley
  Glanbrook
  Orangeville
  West_Carleton
  Gloucester
  Orillia
  West_Lincoln
  Goulbourn
  Osgoode
  Whitby
  Gravenhurst
  Oshawa
  Wilmot
  Grimsby
  Ottawa
  Guelph
  Ottawa_Carleton
  Woolwich
  Haldimand_Norfork
  Owen_Sound
  York
  Alberton
  Montague
  Stratford
  Charlottetown
  Souris
  Summerside
  Alma
  Fleurimont
  Longueuil
  Amos
  Gaspe
  Marieville
  Anjou
  Gatineau
  Mount_Royal
  Aylmer
  Hull
  Montreal
  Beauport
  Joliette
  Montreal_Region
  Bromptonville
  Jonquiere
  Montreal_Est
  Brossard
  Lachine
  Quebec
  Chateauguay
  Lasalle
  Saint_Leonard
  Chicoutimi
  Laurentides
  Sherbrooke
  Coaticook
  LaSalle
  Sorel
  Laval
  Thetford_Mines
  Dorval
  Lennoxville
  Victoriaville
  Drummondville
  Levis
  Avonlea
  Melfort
  Swift_Current
  Colonsay
  Nipawin
  Tisdale
  Craik
  Prince_Albert
  Unity
  Creighton
  Regina
  Weyburn
  Eastend
  Saskatoon
  Wynyard
  Esterhazy
  Shell_Lake
  Yorkton
  Gravelbourg
  Carcross
  Whitehorse
}

enum JobField {
  tech
  finance
  healthcare
  construction
  education
  engineering
  logistics
  retail
  business_admin
  hospitality
  marketing
  legal
  manufacturing
  agriculture
  real_estate
  government
  student
  retired
}

enum CostOfLiving {
  Low
  Medium
  High
}

enum WeatherPreference {
  Cold
  Moderate
  Warm
}

enum Province {
  AB
  BC
  MB
  NB
  NL
  NS
  ON
  PE
  QC
  SK
}

enum LifeStage {
  Student
  Family
  Professional
  Retiree
}

enum LanguagePreference {
  English
  French
  Bilingual
}

enum ImmigrationStatus {
  PR
  Student_Visa
  Work_Permit
  New_Immigrant
}

enum CitySize {
  Small
  Medium
  Large
}
